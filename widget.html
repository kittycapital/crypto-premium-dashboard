<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>í”„ë¦¬ë¯¸ì—„ ìœ„ì ¯</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{--bg:#08080d;--card:#101018;--border:#1c1c2e;--t1:#e8e8f0;--t2:#8888a8;--t3:#555570;--green:#00d68f;--red:#ff3d71;--cyan:#00cfff;--purple:#9966ff;--orange:#f0a030}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--t1);font-family:'Noto Sans KR',sans-serif;scrollbar-width:none;-ms-overflow-style:none}
body::-webkit-scrollbar{display:none}
a{text-decoration:none;color:inherit}

.wrap{padding:12px;max-width:600px;margin:0 auto}
.btc-bar{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px;margin-bottom:10px}
.btc-card{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:10px 12px;text-align:center;cursor:pointer;transition:border-color .2s}
.btc-card:hover{border-color:#2a2a45}
.btc-card .label{font-size:10px;color:var(--t3);margin-bottom:2px}
.btc-card .val{font-family:'JetBrains Mono',monospace;font-weight:700;font-size:16px}
.btc-card .sub{font-size:9px;color:var(--t3);margin-top:2px}
.pos{color:var(--green)}.neg{color:var(--red)}

.boxes{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:8px}
.box{background:var(--card);border:1px solid var(--border);border-radius:8px;padding:12px 14px;cursor:pointer;transition:border-color .2s}
.box:hover{border-color:#2a2a45}
.box h3{font-size:12px;font-weight:700;margin-bottom:8px;display:flex;align-items:center;gap:5px}
.box.prem h3{color:var(--green)}
.box.disc h3{color:var(--red)}

.item{padding:6px 0;border-bottom:1px solid #1c1c2e60}
.item:last-child{border-bottom:none}
.item-row1{display:flex;align-items:center;justify-content:space-between;margin-bottom:2px}
.item-row1 .left{display:flex;align-items:center;gap:6px}
.item-row1 img{width:16px;height:16px;border-radius:50%}
.item-row1 .sym{font-family:'JetBrains Mono',monospace;font-weight:600;font-size:13px}
.item-row1 .best{font-family:'JetBrains Mono',monospace;font-weight:700;font-size:13px}
.item-row2{display:flex;gap:10px;padding-left:22px;font-size:10px}
.item-row2 .ex{color:var(--t3)}
.item-row2 .val{font-family:'JetBrains Mono',monospace;font-weight:500}

.more{text-align:center;font-size:10px;color:var(--t3);padding:4px 0}
.more span{color:var(--cyan);font-weight:500}

@media(max-width:400px){.boxes{grid-template-columns:1fr}.btc-bar{grid-template-columns:1fr}.btc-card .val{font-size:14px}}
</style>
</head>
<body>
<a href="https://herdvibe.com/60" target="_top">
<div class="wrap">
  <div class="btc-bar">
    <div class="btc-card"><div class="label">USD/KRW</div><div class="val" id="wRate">Â·Â·Â·</div><div class="sub">ì‹¤ì‹œê°„ ì—­ì‚°</div></div>
    <div class="btc-card"><div class="label">BTC ê¹€ì¹˜í”„ë¦¬ë¯¸ì—„</div><div class="val" id="wKimchi">Â·Â·Â·</div><div class="sub">ì—…ë¹„íŠ¸ vs Binance</div></div>
    <div class="btc-card"><div class="label">BTC ì½”ì¸ë² ì´ìŠ¤</div><div class="val" id="wCB">Â·Â·Â·</div><div class="sub">ì½”ì¸ë² ì´ìŠ¤ vs Binance</div></div>
  </div>
  <div class="boxes">
    <div class="box prem"><h3>ğŸ”º í”„ë¦¬ë¯¸ì—„ TOP 5</h3><div id="topList">ë¡œë”© ì¤‘...</div></div>
    <div class="box disc"><h3>ğŸ”» ë””ìŠ¤ì¹´ìš´íŠ¸ TOP 5</h3><div id="botList">ë¡œë”© ì¤‘...</div></div>
  </div>
  <div class="more">í´ë¦­í•˜ë©´ <span>ì „ì²´ ëŒ€ì‹œë³´ë“œ</span>ì—ì„œ í™•ì¸ â†’</div>
</div>
</a>

<script>
const fmtPct=v=>(v>0?'+':'')+v.toFixed(2)+'%';
const pCls=v=>v>0?'pos':'neg';

async function load(){
  try{
    const sr=await fetch('data/coins.json?t='+Date.now());
    const serverData=await sr.json();
    const coins=serverData.coins||[];
    const usdKrw=serverData.usd_krw||1450;

    const bnR=await fetch('https://api.binance.com/api/v3/ticker/price');
    const bnData=await bnR.json();
    const bn={};
    bnData.forEach(t=>{if(t.symbol.endsWith('USDT'))bn[t.symbol.replace('USDT','')]=+t.price;});

    document.getElementById('wRate').textContent=usdKrw.toFixed(0)+'ì›';

    const results=[];
    for(const coin of coins){
      const sym=coin.symbol;
      const bnP=bn[sym];
      if(!bnP||bnP<=0)continue;

      const entry={symbol:sym,image:coin.image||''};
      const vals=[];

      if(coin.upbit_krw&&usdKrw){
        const p=((coin.upbit_krw/usdKrw)-bnP)/bnP*100;
        entry.up=p;vals.push({v:p,src:'ì—…ë¹„íŠ¸'});
      }
      if(coin.bithumb_krw&&usdKrw){
        const p=((coin.bithumb_krw/usdKrw)-bnP)/bnP*100;
        entry.bt=p;vals.push({v:p,src:'ë¹—ì¸'});
      }
      if(coin.coinbase_usd){
        const p=(coin.coinbase_usd-bnP)/bnP*100;
        if(Math.abs(p)<=10){entry.cb=p;vals.push({v:p,src:'ì½”ì¸ë² ì´ìŠ¤'});}
      }

      if(vals.length){
        vals.sort((a,b)=>b.v-a.v);
        entry.maxV=vals[0].v;entry.maxSrc=vals[0].src;
        entry.minV=vals[vals.length-1].v;entry.minSrc=vals[vals.length-1].src;
        entry.allVals=vals;
        results.push(entry);

        if(sym==='BTC'){
          if(entry.up!=null){const el=document.getElementById('wKimchi');el.textContent=fmtPct(entry.up);el.className='val '+pCls(entry.up);}
          if(entry.cb!=null){const el=document.getElementById('wCB');el.textContent=fmtPct(entry.cb);el.className='val '+pCls(entry.cb);}
        }
      }
    }

    results.sort((a,b)=>b.maxV-a.maxV);
    const top5=results.slice(0,5);
    const bot5=[...results].sort((a,b)=>a.minV-b.minV).slice(0,5);

    const renderItem=(c,type)=>{
      const bestVal=type==='prem'?c.maxV:c.minV;
      const cls=pCls(bestVal);
      const details=c.allVals.map(v=>`<span><span class="ex">${v.src}</span> <span class="val ${pCls(v.v)}">${fmtPct(v.v)}</span></span>`).join(' ');
      return`<div class="item">
        <div class="item-row1">
          <div class="left"><img src="${c.image}" onerror="this.style.display='none'"><span class="sym">${c.symbol}</span></div>
          <span class="best ${cls}">${fmtPct(bestVal)}</span>
        </div>
        <div class="item-row2">${details}</div>
      </div>`;
    };

    document.getElementById('topList').innerHTML=top5.map(c=>renderItem(c,'prem')).join('');
    document.getElementById('botList').innerHTML=bot5.map(c=>renderItem(c,'disc')).join('');

  }catch(e){
    console.error(e);
    document.getElementById('topList').textContent='ë¡œë”© ì‹¤íŒ¨';
    document.getElementById('botList').textContent='ë¡œë”© ì‹¤íŒ¨';
  }
}
load();

function postHeight(){const h=document.documentElement.scrollHeight;window.parent.postMessage({type:'resize',height:h},'*');window.parent.postMessage({height:h},'*');}
new ResizeObserver(()=>postHeight()).observe(document.body);
window.addEventListener('load',()=>setTimeout(postHeight,300));
</script>
</body>
</html>
